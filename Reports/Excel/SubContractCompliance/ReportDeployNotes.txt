2015.08.07 - LWO
--------------------------------------------------------------------------------------------------------------
Viewpoint Report ID: 10139
Viewpoint Report Name: "MCK Subcontract Compliance Audit"
Viewpoint Report Filename: SubcontractComplianceAudit.xltm
Workbook Password: (see passwordstate) [for secured VBA code and worksheet locking)

TFS Repository: $/ViewPoint/Reports/Excel/SubContractCompliance

--------------------------------------------------------------------------------------------------------------

Once all Viewpoint enhancements are completed (e.g. UD Fields, UD Tables, Form alterations, trigger implementation, etc.) to support the new Subcontract
Document Status (with date changed and by whom) on the Subcontract, Subcontract Change Order and Master and Sample Subcontract entities (including the 
new audit trail table needs), a script needs to be run to peform and initial population of these values from our Echosign services.

The source data and script to do the data population is stored in the .\EchosignData directory.

Selects source data from [MCKTESTSQL04\VIEWPOINT].[MCK_INTEGRATION].[dbo].[EchosignData_Scrubbed] 
via linked server connection so this can run from any of our Viewpoint servers but then interacts with Viewpoint data via
local server cross database syntax (e.g. Viewpoint.dbo.SLHD).

This approach should allow this to be run on MCKTESTSQL04\VIEWPOINT, VPSTAGINGAG\VIEWPOINT and VIEWPOINTAG\VIEWPOINT without modification (assuming the 
MCKTESTSQL04\VIEWPOINT linked server definition is present.

When ready, run
	.\EchosignData\InitialDocStatusUpdate.sql
	
**** NOTE:  We have a new source file that will include Subcontracts, Change Orders and Master Subcontracts.
****        Subsequent Development is needed to get this data in the system.

All SQL elements are created Development and need to be created in other environemnts. The source is assembled in the solution root folder.  
All objects will be dropped and recreated.
	.\mvwSLComplianceSuperSet.sql
	.\mvwSLSubcontractList.sql

Verify the appropriate connection strings in each of Excel workbooks.

Launch Excel
Open respective SubcontractComplianceAudit.xltm file (do not double click on the xltm file as it is a template and will lauch a new "instance"
Navigate to the "Data" tab
Click the "Connections" button
For each listed Connection, click the "Properties" button, then the "Definition" tab and verify the connection information.
When complete, save the xltm file.

Note:  
If you test using the actual xltm file , be sure to reset the queries so that the where clause includes "1=0" 
and refresh before saving.  Also reset the default value of the "Snapshot Month" field on the "Overview" tab (cell M2) to be "=EOMONTH(NOW(),-1)+1"
This will allow the workbook to be saved with no data preloaded and the "Snapshot Month" to be defaulted to the first day of the current month.

.\Development 	= Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;Data Source=MCKTESTSQL04\VIEWPOINT;Application Intent=ReadOnly;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=SEABILLOXPS;Use Encryption for Data=False;Tag with column collation when possible=False;Initial Catalog=Viewpoint
.\Staging 	= Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;Data Source=VPSTAGINGAG\VIEWPOINT;Application Intent=ReadOnly;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=SEABILLOXPS;Use Encryption for Data=False;Tag with column collation when possible=False;Initial Catalog=Viewpoint
.\Production 	= Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;Data Source=VIEWPOINTAG\VIEWPOINT;Application Intent=ReadOnly;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=SEABILLOXPS;Use Encryption for Data=False;Tag with column collation when possible=False;Initial Catalog=Viewpoint


Copy the respective xltm files to the appropiate Viewpoint application servers.
copy .\Development\SubcontractComplianceAudit.xltm "\\setestVIEWPOINT\Viewpoint Repository\Reports\Custom\TrustedAPP\SubcontractComplianceAudit.xltm" /Y
copy .\Staging\SubcontractComplianceAudit.xltm "\\sestgviewpoint\Viewpoint Repository\Reports\Custom\TrustedAPP\SubcontractComplianceAudit.xltm" /Y
copy .\Production\SubcontractComplianceAudit.xltm "\\mckviewpoint\Viewpoint Repository\Reports\Custom\TrustedAPP\SubcontractComplianceAudit.xltm" /Y

Verify Report settings in Viewpoint
Log into each Viewpoint system (Development, Staging and Production)
Navigate to the "Reports/Programs"
Run "Report Titles"
Verify/Create report (currently 10139)

	* INFO TAB *
	Application: Other
	Report Location: Custom_PM
	FileName: SubcontractComplianceAudit.xltm
	Title: MCK Subcontract Compliance Audit
	Report Type: Acct
	Memo: MCK Subcontract Compliance Audit
	Description: MCK Subcontract Compliance Audit
	Icon: CHECKS

	* ASSIGNED MODULES TAB *
	Module(s): PM, RP & SL
	
	* ASSIGNED FORMS TAB *
	Form(s): n/a

Navigate to the "Viewpoint Administration/Programs"
Run "VA Report Security"
Verify/Create report security so that the following groups are "Allowed" access to the report.
	Allowed Group: 	(2) 	All Reports
			(510)	IT Admin Reports
			(1198)	TEMP ERP Team
	

Verify Operations
Log into each Viewpoint system (Development, Staging and Production)
Navigate to the "Accounts Receivable (AR)/Reports"
Run the "MCK Subcontract Compliance Audit" report
Use the "Refresh" button to populate data into the workbook instance.
Navigate to the "SubcontractCompliancePivot" tab.
Double click on any of the summary dollar amounts (e.g. the Subcontract count for the first record)
In the resulting sheet, navigate to the last column and review the last five columns.
Ensure that the "Source" column matches with the Viewpoint environment you lanched the report from.

