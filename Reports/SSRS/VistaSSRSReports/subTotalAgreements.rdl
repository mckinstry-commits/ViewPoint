<?xml version="1.0" encoding="utf-8"?>
<Report MustUnderstand="df" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:df="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition/defaultfontfamily">
  <df:DefaultFontFamily>Segoe UI</df:DefaultFontFamily>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="Viewpoint">
      <DataSourceReference>Viewpoint</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>b041bd6a-fb38-4a50-b96e-12b709145ab0</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="AgreementTotals">
      <Query>
        <DataSourceName>Viewpoint</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@AsofDate">
            <Value>=Parameters!AsofDate.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>/*
Created By Elizabeth Jayne Stitt EJS
Created date 2018/11/01

Modified 2018/11/15 EJS --Deprecated two of the joins that I had initially found pricing on, added Customer Details


Modified

2018/11/05 EJS PREHFullName causing dups because of employee number being in multiple companies, but (in theory) only one company is active.  Added function to just get one record the first 
active or the first last current record

Most records in SMAgreementService don't have multiple service centers or divisions, but some do at the time of this code's creation. 
Pricing is SUPPOSED to be entered individually, but the observation is that when it's the same department, it isn't. Instead it's entered only at the agreement level.
Consequently there are multiple agreement/revision lines returned from SMAgreementService with no pricing information. This is supposed to be the desired source for pricing when not null.
However, there is no way to know how to split prices among the multiple lines when multiple rows are retured.  This will cause dollar amounts to be overstated.

The ServiceSite field also causes this issue.

I can detect this situation and I have created the query so that any record that has duplicate entries will have a dupflag value of 1.  I use this in SSRS to highlight discrepant
line items in the report.

I'm still prototyping this and am getting pricing information from several sources. I hope to be able to bring it down to 3 sources or fewer.
*/
set nocount on

Declare @SMASdup table(SMCo	bCompany, Agreement varchar(15), Revision int, Scnt int null, Dcnt int null, SScnt int null, Price bDollar null,  PRIMARY KEY ([SMCo] ASC, [Agreement] ASC, [Revision] ASC))
Declare @SMASdiv table(dupflag int, SMCo bCompany, Agreement varchar(15),Revision int,ServiceCenter varchar(10), Division varchar(10), Price bDollar null, Scnt int null, Dcnt int null,   PRIMARY KEY ([SMCo] ASC, [Agreement] ASC, [Revision] ASC, ServiceCenter ASC, Division ASC))
Declare @PREHNames Table (Employee bEmployee, FullName varchar(83), ActiveYN bYN, PRCo bCompany, Email varchar(60), RowN int, PRIMARY KEY (PRCo asc, Employee ASC))



--Find duplicate service center/ division record counts
Insert @SMASdup
Select  
      SMCo, Agreement, Revision
	, count(distinct ServiceCenter) SCnt
	, count(distinct Division) DCnt
	, count(distinct ServiceSite) SScnt
	, sum(PricingPrice) Price 
	from SMAgreementService group by SMCo, Agreement, Revision--, ServiceCenter, Division 
	having count(distinct ServiceCenter) &gt; 1 or count(distinct Division) &gt;1 or count(distinct ServiceSite) &gt; 1
	--10119
--select * from @SMASdup

--Get Pricing by SMCo, Agreement, Revision, ServiceCenter, and Division. Flag records that will generate duplicate pricing results (any count &gt; 1 where price is also null).
Insert @SMASdiv
Select case when dup.Scnt &gt;1 or dup.Dcnt&gt;1 and a.Price is null then 1 else 0 end dupflag, 
a.*, dup.Scnt,dup.Dcnt
from ( select SMCo, Agreement, Revision, ServiceCenter, Division, sum(PricingPrice) Price from SMAgreementService where ServiceCenter is not null group by SMCo, Agreement, Revision, ServiceCenter, Division ) a
left join @SMASdup dup  on dup.SMCo=a.SMCo and dup.Agreement=a.Agreement and dup.Revision=a.Revision

--select * from @SMASdiv
-- Get one distinct record for Employee 
insert @PREHNames
Select * from (

select * from (
select *, ROW_NUMBER() over(Partition by udAccountExec order by udAccountExec desc, ActiveYN desc) RowN from (  
select  udAccountExec, p.FullName, ActiveYN, PRCo, Email from PREHFullName p
Join (select distinct udAccountExec from dbo.SMServiceSite) s on p.Employee = s.udAccountExec) q
) AE1
where AE1.RowN=1
union
select * from (
select *, ROW_NUMBER() over(Partition by udAccountExec2 order by udAccountExec2 desc, ActiveYN desc) RowN from (  
select  udAccountExec2, p.FullName, ActiveYN, PRCo, Email from PREHFullName p
Join (select distinct udAccountExec2 from dbo.SMServiceSite) s on p.Employee = s.udAccountExec2) q
) AE2
where AE2.RowN=1
union

select * from (
select *, ROW_NUMBER() over(Partition by udAccountMgr order by udAccountMgr desc, ActiveYN desc) RowN from (  
select  udAccountMgr, p.FullName, ActiveYN, PRCo, Email from PREHFullName p
Join (select distinct udAccountMgr from dbo.SMServiceSite) s on p.Employee = s.udAccountMgr) q
) AM1
where AM1.RowN=1
union
select * from (
select *, ROW_NUMBER() over(Partition by udAccountMgr2 order by udAccountMgr2 desc, ActiveYN desc) RowN from (  
select  udAccountMgr2, p.FullName, ActiveYN, PRCo, Email from PREHFullName p
Join (select distinct udAccountMgr2 from dbo.SMServiceSite) s on p.Employee = s.udAccountMgr2) q
) AM2
where AM2.RowN=1
) q

order by ActiveYN, FullName
--where q.ActiveYN='Y'


--Select *  from PREHNames

--Result Set
select 
 isnull('AM1:'+pm1.FullName + ' ','') + isnull('AE1:'+pe1.FullName + ' ','') + isnull('AM2:'+pm2.FullName + ' ','') + isnull('AE2:'+pe2.FullName + ' ','') AcctMgrs --For report grouping purposes
 
,sum(isnull(dupflag,0)) dupflag --Duplicate records indicator
--, isnull(a.Agreement+'/','')+isnull(cast(a.Revision as varchar(20)),'') ARGroup
--, a.SMCo,a.Agreement,a.Revision
--, vss.ServiceSite, vss.TrueDescription
--, vss.Address1, vss.Address2, vss.Zip
--, vss.TrueCustomer
--, ARCM.Name Customer_Name,ARCM.Address Customer_Address,ARCM.Address2 Customer_Address2,ARCM.City Customer_City,ARCM.[State] Customer_State, ARCM.Zip Customer_Zip
--, pm1.FullName AcctMgr1, vss.udAccountMgr
--, pe1.FullName AcctExe1, vss.udAccountExec
--, pm2.FullName AcctMgr2, vss.udAccountMgr2
--, pe2.FullName AcctExe2,vss.udAccountExec2
--, vss.udAccountCat
----, No Company Group substitute for Astea column on report
--, a.EffectiveDate,a.ExpirationDate
----, No PreAuth source known
----Not sure where to get Agreement, but if detail pricing exists in SMAS.price use that instead of a.AgreementPrice
, sum( coalesce (smas.Price, a.AgreementPrice  /*,mae.AgreementPrice , vatx.AgreementPrice*/)) AgreementPrice --Removed other questionalble sources
--, sum( isnull( cast(coalesce (  smas.Price-smas.Price +1,a.AgreementPrice-a.AgreementPrice +2/*, mae.AgreementPrice-mae.AgreementPrice +3, vatx.AgreementPrice-vatx.AgreementPrice +4*/) as int),0)) APind
--, case  isnull(coalesce (  smas.Price-smas.Price +1,a.AgreementPrice-a.AgreementPrice +2/*, mae.AgreementPrice-mae.AgreementPrice +3, vatx.AgreementPrice-vatx.AgreementPrice +4*/),0) 
--  when 0 then 'No Agreement Price'
--  when 1 then 'SMAgreementService'
--  when 2 then 'Agreement'
--  when 3 then 'mckExtended' --NoLongerUsed
--  when 4 then 'vrv...PriceTaxTotal' --NoLongerUsed
--  else 'Unexpected Source' end APsource
, Sum(a.AgreementPrice) APrice, sum(smas.Price) SMASPrice /*,mae.AgreementPrice MAEPrice, vatx.AgreementPrice VATXPrice */ -- for information purposes, this was where I found pricing information.  

, smas.ServiceCenter, smas.Division , count(Distinct a.Agreement) AgCnt
--, vss.City, vss.[State]


--, a.DateActivated,a.DateCancelled,a.DateCreated,a.DateTerminated,a.StartDate
--,  * 
from SMAgreement a --where Revision is null

--left Join  SMAgreementExtended ae on a.Agreement=ae.Agreement and a.Revision=ae.Revision and a.SMCo=ae.SMCo --using MAE instead
--left join mckSMAgreementExtended mae on a.Agreement=mae.Agreement and a.Revision=mae.Revision and a.SMCo=mae.SMCo --Deprecated as a source
--left join vrvSMAgreementPriceTaxTotal vatx on a.Agreement=vatx.Agreement and a.Revision=vatx.Revision and a.SMCo=vatx.SMCo --Deprecated as a source
--This has Service Site to Agreement
left join(select distinct SMCo,Agreement,Revision,ServiceSite from dbo.SMAgreementService) ai on ai.Agreement=a.Agreement and ai.Revision=a.Revision and ai.SMCo=a.SMCo
--This has customer and manager fields.
left join vrvSMServiceSiteCustomer vss on vss.SMCo=a.SMCo and vss.ServiceSite=ai.ServiceSite
--Get names for manager fields
left join @PREHNames pm1 on pm1.Employee=vss.udAccountMgr
left join @PREHNames pm2 on pm2.Employee=vss.udAccountMgr2
left join @PREHNames pe1 on pe1.Employee=vss.udAccountExec
left join @PREHNames pe2 on pe2.Employee=vss.udAccountExec2
--left join @SMASdup dup on dup.SMCo=a.SMCo and dup.Agreement=a.Agreement and dup.Revision=a.Revision --Switched to a declared table
--left join (Select  SMCo, Agreement, Revision, ServiceCenter, Division, sum(PricingPrice) Price from SMAgreementService group by SMCo, Agreement, Revision, ServiceCenter, Division  ) smas on smas.SMCo=a.SMCo and smas.Agreement=a.Agreement and smas.Revision=a.Revision
left join @SMASdiv smas on smas.SMCo=a.SMCo and smas.Agreement=a.Agreement and smas.Revision=a.Revision
left join ARCM on ARCM.Customer=vss.TrueCustomer and ARCM.CustGroup=vss.TrueCustGroup

where a.DateCancelled is null and a.DateTerminated is null and @AsofDate between a.EffectiveDate and a.ExpirationDate
and ( (isnull('AM1:'+pm1.FullName + ' ','') + isnull('AE1:'+pe1.FullName + ' ','') + isnull('AM2:'+pm2.FullName + ' ','') + isnull('AE2:'+pe2.FullName + ' ','') ) &lt;&gt; '')
group by isnull('AM1:'+pm1.FullName + ' ','') + isnull('AE1:'+pe1.FullName + ' ','') + isnull('AM2:'+pm2.FullName + ' ','') + isnull('AE2:'+pe2.FullName + ' ','')  --For report grouping purposes
 , smas.ServiceCenter, smas.Division
order by 1,6,7</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="AcctMgrs">
          <DataField>AcctMgrs</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="dupflag">
          <DataField>dupflag</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="AgreementPrice">
          <DataField>AgreementPrice</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="APrice">
          <DataField>APrice</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="SMASPrice">
          <DataField>SMASPrice</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ServiceCenter">
          <DataField>ServiceCenter</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Division">
          <DataField>Division</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="AgCnt">
          <DataField>AgCnt</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="table1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>3in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontFamily />
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>#666666</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <rd:Selected>true</rd:Selected>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox6">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontFamily />
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>#666666</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox6</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox8">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontFamily />
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>#666666</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox8</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox9">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontFamily />
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>#666666</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox9</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox10">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontFamily />
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>#666666</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox10</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.22in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox2">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>Acct Mgrs</Value>
                                  <Style>
                                    <FontFamily />
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>#666666</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox2</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <FontFamily />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox3">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>Agreement Price</Value>
                                  <Style>
                                    <FontFamily />
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>#666666</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <FontFamily />
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox3</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <FontFamily />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox7">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>Agree Cnt</Value>
                                  <Style>
                                    <FontFamily />
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>#666666</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox7</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox4">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>Service Center</Value>
                                  <Style>
                                    <FontFamily />
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>#666666</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox4</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <FontFamily />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox5">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>Division</Value>
                                  <Style>
                                    <FontFamily />
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>#666666</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox5</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <FontFamily />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.21in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="AcctMgrs">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!AcctMgrs.Value</Value>
                                  <Style>
                                    <FontFamily />
                                    <Color>#333333</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>AcctMgrs</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <FontFamily />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="AgreementPrice">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!AgreementPrice.Value</Value>
                                  <Style>
                                    <FontFamily />
                                    <Format>#,0.00;(#,0.00)</Format>
                                    <Color>#333333</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>AgreementPrice</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <BackgroundColor>=iif(Fields!dupflag.Value&gt;0,"Red","White")</BackgroundColor>
                            <FontFamily />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="AgCnt">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!AgCnt.Value</Value>
                                  <Style>
                                    <FontFamily />
                                    <Color>#333333</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>AgCnt</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <BackgroundColor>=iif(Fields!dupflag.Value&gt;0,"Red","White")</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ServiceCenter">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!ServiceCenter.Value</Value>
                                  <Style>
                                    <FontFamily />
                                    <Color>#333333</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>ServiceCenter</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <FontFamily />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Division">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!Division.Value</Value>
                                  <Style>
                                    <FontFamily />
                                    <Color>#333333</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Division</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                            </Border>
                            <BottomBorder>
                              <Style>Solid</Style>
                            </BottomBorder>
                            <FontFamily />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <RepeatOnNewPage>true</RepeatOnNewPage>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <RepeatOnNewPage>true</RepeatOnNewPage>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <Group Name="table1_Details_Group">
                    <DataElementName>Detail</DataElementName>
                  </Group>
                  <TablixMembers>
                    <TablixMember />
                  </TablixMembers>
                  <DataElementName>Detail_Collection</DataElementName>
                  <DataElementOutput>Output</DataElementOutput>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>AgreementTotals</DataSetName>
            <Height>0.68in</Height>
            <Width>7in</Width>
            <Style />
          </Tablix>
        </ReportItems>
        <Height>3.06833in</Height>
        <Style />
      </Body>
      <Width>8.25in</Width>
      <Page>
        <LeftMargin>1in</LeftMargin>
        <RightMargin>1in</RightMargin>
        <TopMargin>1in</TopMargin>
        <BottomMargin>1in</BottomMargin>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="AsofDate">
      <DataType>DateTime</DataType>
      <Prompt>Asof Date</Prompt>
    </ReportParameter>
  </ReportParameters>
  <ReportParametersLayout>
    <GridLayoutDefinition>
      <NumberOfColumns>1</NumberOfColumns>
      <NumberOfRows>1</NumberOfRows>
      <CellDefinitions>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>0</RowIndex>
          <ParameterName>AsofDate</ParameterName>
        </CellDefinition>
      </CellDefinitions>
    </GridLayoutDefinition>
  </ReportParametersLayout>
  <Language>en-US</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportID>9fa37403-d609-42b0-8754-8e85e133366e</rd:ReportID>
</Report>